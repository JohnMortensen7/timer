<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Interval Timer</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #1A1A2E;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            overflow: hidden;
        }

        h1 {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .interval-label {
            font-size: 18px;
            color: #888;
            margin-bottom: 30px;
            height: 24px;
        }

        .timer-display {
            font-size: 72px;
            font-family: 'Courier New', monospace;
            font-weight: 300;
            margin-bottom: 40px;
        }

        .timer-button {
            width: 250px;
            height: 250px;
            border-radius: 50%;
            border: 4px solid #16213E;
            background: linear-gradient(135deg, #E94560, #0F3460);
            color: white;
            font-size: 32px;
            font-weight: bold;
            cursor: pointer;
            outline: none;
            transition: transform 0.1s ease;
            box-shadow: 0 8px 30px rgba(233, 69, 96, 0.3);
        }

        .timer-button:active {
            transform: scale(0.95);
        }

        .timer-button.running {
            background: linear-gradient(135deg, #0F3460, #E94560);
        }

        .instructions {
            margin-top: 40px;
            font-size: 14px;
            color: #666;
        }

        .ding-info {
            margin-top: 8px;
            font-size: 14px;
            color: #666;
        }
    </style>
</head>
<body>
    <h1>Interval Timer</h1>
    <div class="interval-label" id="intervalLabel">Press to Start</div>
    <div class="timer-display" id="timerDisplay">00:00</div>
    <button class="timer-button" id="timerButton">START</button>
    <div class="instructions">10s â†’ 30s â†’ 10s â†’ 30s...</div>
    <div class="ding-info">ðŸ””ðŸ”” = 10s &nbsp;|&nbsp; ðŸ”” = 30s</div>

    <script>
        let audioContext = null;

        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }
        }

        // Realistic bell ding sound
        function playDing() {
            if (!audioContext) return;
            
            const now = audioContext.currentTime;
            const fundamental = 880;
            
            const partials = [
                { freq: fundamental * 0.5, amp: 0.4, decay: 2.0 },
                { freq: fundamental, amp: 1.0, decay: 1.8 },
                { freq: fundamental * 2.0, amp: 0.6, decay: 1.2 },
                { freq: fundamental * 2.92, amp: 0.3, decay: 0.9 },
                { freq: fundamental * 4.16, amp: 0.2, decay: 0.6 },
                { freq: fundamental * 5.43, amp: 0.1, decay: 0.4 },
            ];
            
            partials.forEach(partial => {
                const osc = audioContext.createOscillator();
                const gain = audioContext.createGain();
                
                osc.frequency.value = partial.freq;
                osc.type = 'sine';
                
                gain.gain.setValueAtTime(partial.amp * 0.4, now);
                gain.gain.exponentialRampToValueAtTime(0.001, now + partial.decay);
                
                osc.connect(gain);
                gain.connect(audioContext.destination);
                
                osc.start(now);
                osc.stop(now + partial.decay + 0.1);
            });
            
            // Strike sound
            const strikeBuffer = audioContext.createBuffer(1, audioContext.sampleRate * 0.02, audioContext.sampleRate);
            const strikeData = strikeBuffer.getChannelData(0);
            for (let i = 0; i < strikeData.length; i++) {
                strikeData[i] = (Math.random() * 2 - 1) * Math.exp(-i / (audioContext.sampleRate * 0.005));
            }
            
            const strikeSource = audioContext.createBufferSource();
            strikeSource.buffer = strikeBuffer;
            
            const strikeFilter = audioContext.createBiquadFilter();
            strikeFilter.type = 'highpass';
            strikeFilter.frequency.value = 2000;
            
            const strikeGain = audioContext.createGain();
            strikeGain.gain.value = 0.15;
            
            strikeSource.connect(strikeFilter);
            strikeFilter.connect(strikeGain);
            strikeGain.connect(audioContext.destination);
            strikeSource.start(now);
        }

        // Realistic clock tick sound
        function playTick() {
            if (!audioContext) return;
            
            const now = audioContext.currentTime;
            
            const clickDuration = 0.015;
            const bufferSize = Math.floor(audioContext.sampleRate * clickDuration);
            const buffer = audioContext.createBuffer(1, bufferSize, audioContext.sampleRate);
            const data = buffer.getChannelData(0);
            
            for (let i = 0; i < bufferSize; i++) {
                const t = i / audioContext.sampleRate;
                const envelope = Math.exp(-t * 300);
                
                const click = 
                    Math.sin(2 * Math.PI * 3500 * t) * 0.4 +
                    Math.sin(2 * Math.PI * 1200 * t) * 0.3 +
                    Math.sin(2 * Math.PI * 600 * t) * 0.2 +
                    (Math.random() * 2 - 1) * 0.1;
                
                data[i] = click * envelope;
            }
            
            const source = audioContext.createBufferSource();
            source.buffer = buffer;
            
            const gain = audioContext.createGain();
            gain.gain.value = 0.7;
            
            source.connect(gain);
            gain.connect(audioContext.destination);
            source.start(now);
            
            // Tock resonance
            const tockOsc = audioContext.createOscillator();
            const tockGain = audioContext.createGain();
            tockOsc.frequency.value = 400;
            tockOsc.type = 'sine';
            tockGain.gain.setValueAtTime(0.15, now);
            tockGain.gain.exponentialRampToValueAtTime(0.001, now + 0.05);
            tockOsc.connect(tockGain);
            tockGain.connect(audioContext.destination);
            tockOsc.start(now);
            tockOsc.stop(now + 0.06);
        }

        async function playDings(count) {
            for (let i = 0; i < count; i++) {
                playDing();
                if (i < count - 1) {
                    await new Promise(resolve => setTimeout(resolve, 500));
                }
            }
        }

        let isRunning = false;
        let isShortInterval = true;
        let secondsRemaining = 0;
        let timerInterval = null;
        let tickInterval = null;

        const timerButton = document.getElementById('timerButton');
        const timerDisplay = document.getElementById('timerDisplay');
        const intervalLabel = document.getElementById('intervalLabel');

        function updateDisplay() {
            const minutes = Math.floor(secondsRemaining / 60);
            const seconds = secondsRemaining % 60;
            timerDisplay.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        }

        function startInterval(seconds) {
            secondsRemaining = seconds;
            updateDisplay();
            
            intervalLabel.textContent = isShortInterval ? 'Short Interval (10s)' : 'Long Interval (30s)';
            
            if (tickInterval) clearInterval(tickInterval);
            if (timerInterval) clearInterval(timerInterval);
            
            playTick();
            tickInterval = setInterval(() => {
                if (isRunning && secondsRemaining > 0) {
                    playTick();
                }
            }, 1000);
            
            timerInterval = setInterval(() => {
                if (!isRunning) return;
                
                secondsRemaining--;
                updateDisplay();
                
                if (secondsRemaining <= 0) {
                    clearInterval(timerInterval);
                    clearInterval(tickInterval);
                    
                    isShortInterval = !isShortInterval;
                    
                    if (isShortInterval) {
                        playDings(2).then(() => {
                            if (isRunning) startInterval(10);
                        });
                    } else {
                        playDings(1).then(() => {
                            if (isRunning) startInterval(30);
                        });
                    }
                }
            }, 1000);
        }

        function startTimer() {
            initAudio();
            isRunning = true;
            isShortInterval = true;
            timerButton.textContent = 'STOP';
            timerButton.classList.add('running');
            
            playDings(2).then(() => {
                if (isRunning) startInterval(10);
            });
        }

        function stopTimer() {
            isRunning = false;
            if (timerInterval) clearInterval(timerInterval);
            if (tickInterval) clearInterval(tickInterval);
            
            timerButton.textContent = 'START';
            timerButton.classList.remove('running');
            timerDisplay.textContent = '00:00';
            intervalLabel.textContent = 'Press to Start';
            isShortInterval = true;
        }

        timerButton.addEventListener('click', () => {
            if (isRunning) {
                stopTimer();
            } else {
                startTimer();
            }
        });
    </script>
</body>
</html>
